<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='CoMLRL supports both homogeneous and heterogeneous models. Users can assign agent_model/critic_model with HuggingFace model identifiers for homogeneous setups, or provide agents/critics lists for heterogeneous setups.
Homogeneous Agents# The easiest way to start the journey of CoMLRL is to load num_agents homogeneous agents with a single model identifier. Users can set agent_model.name to a single model identifier while keeping agents: null.
For example, to load 3 Qwen/Qwen2.5-1.5B agents:
trainer = MAGRPOTrainer( agent_model="Qwen/Qwen2.5-1.5B", agents=None, num_agents=3, )Heterogeneous Agents# Although homogeneous LLM agents can be specified into different roles by prompting, using heterogeneous LLMs with different skills can further unleash the potential of multi-agent collaboration. Users can load a list of heterogeneous agents in agents, where the length of the list should match num_agents. Each entry should specify a model identifier and optional tokenizer/model kwargs. When agents is provided, agent_model should be set to null or ignored; if both are provided, they must match (same names, correct length) or training will raise an error.
'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="/docs/user-guide/model-loading/"><meta property="og:site_name" content="CoMLRL"><meta property="og:title" content="Model Loading"><meta property="og:description" content='CoMLRL supports both homogeneous and heterogeneous models. Users can assign agent_model/critic_model with HuggingFace model identifiers for homogeneous setups, or provide agents/critics lists for heterogeneous setups.
Homogeneous Agents# The easiest way to start the journey of CoMLRL is to load num_agents homogeneous agents with a single model identifier. Users can set agent_model.name to a single model identifier while keeping agents: null.
For example, to load 3 Qwen/Qwen2.5-1.5B agents:
trainer = MAGRPOTrainer( agent_model="Qwen/Qwen2.5-1.5B", agents=None, num_agents=3, )Heterogeneous Agents# Although homogeneous LLM agents can be specified into different roles by prompting, using heterogeneous LLMs with different skills can further unleash the potential of multi-agent collaboration. Users can load a list of heterogeneous agents in agents, where the length of the list should match num_agents. Each entry should specify a model identifier and optional tokenizer/model kwargs. When agents is provided, agent_model should be set to null or ignored; if both are provided, they must match (same names, correct length) or training will raise an error.'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2026-02-13T16:23:08-05:00"><meta itemprop=name content="Model Loading"><meta itemprop=description content='CoMLRL supports both homogeneous and heterogeneous models. Users can assign agent_model/critic_model with HuggingFace model identifiers for homogeneous setups, or provide agents/critics lists for heterogeneous setups.
Homogeneous Agents# The easiest way to start the journey of CoMLRL is to load num_agents homogeneous agents with a single model identifier. Users can set agent_model.name to a single model identifier while keeping agents: null.
For example, to load 3 Qwen/Qwen2.5-1.5B agents:
trainer = MAGRPOTrainer( agent_model="Qwen/Qwen2.5-1.5B", agents=None, num_agents=3, )Heterogeneous Agents# Although homogeneous LLM agents can be specified into different roles by prompting, using heterogeneous LLMs with different skills can further unleash the potential of multi-agent collaboration. Users can load a list of heterogeneous agents in agents, where the length of the list should match num_agents. Each entry should specify a model identifier and optional tokenizer/model kwargs. When agents is provided, agent_model should be set to null or ignored; if both are provided, they must match (same names, correct length) or training will raise an error.'><meta itemprop=dateModified content="2026-02-13T16:23:08-05:00"><meta itemprop=wordCount content="433"><title>Model Loading | CoMLRL</title><link rel=icon href=../../../favicon.png><link rel=manifest href=../../../manifest.json><link rel=canonical href=../../../docs/user-guide/model-loading/><link rel=stylesheet href=../../../book.min.cf77f74a94d5d5797fce47774a1371342c8a7d81e76bbc31dd6c3ba4e268e9a2.css><script defer src=../../../fuse.min.js></script><script defer src=../../../en.search.min.a2d091a143a3683cc0ac8052c8fc4c5efb5598a776bc019e77cd12eceaa93413.js></script><link rel=stylesheet href=../../../katex/katex.min.css><script defer src=../../../katex/katex.min.js></script><script defer src=../../../katex/auto-render.min.js onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0}],throwOnError:!1})'></script><link rel=stylesheet href=../../../css/sidebar.css><link rel=icon type=image/svg+xml href=../../../img/comlrl-icon.svg><link rel=icon type=image/png href=../../../img/comlrl-icon.png><link rel="shortcut icon" type=image/png href=../../../img/comlrl-icon.png><link rel=apple-touch-icon href=../../../img/comlrl-icon.png><script>document.addEventListener("DOMContentLoaded",function(){try{var t,n,s,o,e=document.querySelector("article.book-article");if(!e)return;if(n=document.querySelector(".book-header h3"),t=n?n.textContent.trim():(document.title||"").split("|")[0].trim(),!t)return;s=e.querySelector("h1"),(!s||s.textContent.trim()!==t)&&(o=document.createElement("h1"),o.textContent=t,e.insertBefore(o,e.firstChild)),function(){var t,e=document.getElementById("omlrl-footer");e||(e=document.createElement("div"),e.id="omlrl-footer",e.className="omlrl-footer",document.body.appendChild(e)),e.textContent="",t=document.createElement("strong"),t.textContent="Â© OpenMLRL. All rights reserved.",e.appendChild(t)}()}catch{}}),document.addEventListener("keydown",function(e){if(!e.metaKey&&!e.ctrlKey)return;var n,t=(e.key||"").toLowerCase();if(t==="k"){e.preventDefault(),n=document.querySelector(".book-search input"),n&&n.focus();return}if(t==="o"){e.preventDefault(),window.location.href="https://openmlrl.github.io";return}if(t==="g"){e.preventDefault(),window.location.href="https://github.com/OpenMLRL/CoMLRL";return}}),document.addEventListener("DOMContentLoaded",function(){var e,t=document.querySelectorAll("pre");t.forEach(function(e){var t=document.createElement("button");t.className="copy-code-button",t.textContent="Copy",t.addEventListener("click",function(){var n=e.querySelector("code"),s=n.textContent;navigator.clipboard.writeText(s).then(function(){t.textContent="Copied!",setTimeout(function(){t.textContent="Copy"},2e3)})}),e.style.position="relative",e.appendChild(t)}),e=document.createElement("a"),e.href="https://github.com/OpenMLRL/CoMLRL",e.className="github-corner",e.target="_blank",e.rel="noopener noreferrer",e.setAttribute("aria-label","View source on GitHub"),e.innerHTML='<svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><defs><linearGradient id="github-gradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#9555af;stop-opacity:1" /><stop offset="100%" style="stop-color:#e091c4;stop-opacity:1" /></linearGradient></defs><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z" fill="url(#github-gradient)"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="#fff" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="#fff" class="octo-body"></path></svg>',document.body.appendChild(e)})</script></head><body dir=ltr class="book-kind-page book-type-docs"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=../../../><img src=../../../img/comlrl-logo.png alt=Logo><span>CoMLRL</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><a>User Guide</a><ul><li><a href=../../../docs/user-guide/installation/>Installation</a></li><li><a href=../../../docs/user-guide/model-loading/ class=active>Model Loading</a></li><li><a href=../../../docs/user-guide/multi-agent-reinforce/>Multi-Agent REINFORCE</a></li><li><a href=../../../docs/user-guide/multi-agent-actor-critic/>Multi-Agent Actor-Critic</a></li><li><a href=../../../docs/user-guide/multi-turn-training/>Multi-Turn Training</a></li></ul></li><li class=book-section-flat><a>Examples</a><ul><li><a href=../../../docs/examples/comlrl-quick-start/>CoMLRL Quick Start</a></li></ul></li><li class=book-section-flat><a>Developers</a><ul><li><a href=../../../docs/dev/support/>Support</a></li><li><a href=../../../docs/dev/contributing/>Contributing</a></li><li><a href=../../../docs/dev/changelog/>Changelog</a></li></ul></li><li class=book-section-flat><a href=../../../docs/env/>Environments</a><ul><li><a href=https://github.com/OpenMLRL/LLM_Collab_Writing target=_blank rel=noopener>Writing</a></li><li><a href=https://github.com/OpenMLRL/LLM_Collab_Code_Generation target=_blank rel=noopener>Coding</a></li><li><a href=https://github.com/OpenMLRL/LLM_Collab_Minecraft target=_blank rel=noopener>Minecraft</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=../../../icons/menu.svg class=book-icon alt=Menu></label><h3>Model Loading</h3><label for=toc-control></label></div></header><article class="markdown book-article"><p>CoMLRL supports both homogeneous and heterogeneous models.
Users can assign <code>agent_model</code>/<code>critic_model</code> with <a href=https://huggingface.co/models>HuggingFace model identifiers</a> for homogeneous setups, or provide <code>agents</code>/<code>critics</code> lists for heterogeneous setups.</p><h2 id=homogeneous-agents>Homogeneous Agents<a class=anchor href=#homogeneous-agents>#</a></h2><p>The easiest way to start the journey of CoMLRL is to load <code>num_agents</code> homogeneous agents with a single model identifier.
Users can set <code>agent_model.name</code> to a single model identifier while keeping <code>agents: null</code>.</p><p>For example, to load 3 <em>Qwen/Qwen2.5-1.5B</em> agents:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>trainer <span style=color:#666>=</span> MAGRPOTrainer(
</span></span><span style=display:flex><span>    agent_model<span style=color:#666>=</span><span style=color:#4070a0>&#34;Qwen/Qwen2.5-1.5B&#34;</span>,
</span></span><span style=display:flex><span>    agents<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>,
</span></span><span style=display:flex><span>    num_agents<span style=color:#666>=</span><span style=color:#40a070>3</span>,
</span></span><span style=display:flex><span>)</span></span></code></pre></div><h2 id=heterogeneous-agents>Heterogeneous Agents<a class=anchor href=#heterogeneous-agents>#</a></h2><p>Although homogeneous LLM agents can be specified into different roles by prompting, using heterogeneous LLMs with different skills can further unleash the potential of multi-agent collaboration.
Users can load a list of heterogeneous agents in <code>agents</code>, where the length of the list should match <code>num_agents</code>. Each entry should specify a model identifier and optional tokenizer/model kwargs.
When <code>agents</code> is provided, <code>agent_model</code> should be set to null or ignored; if both are provided, they must match (same names, correct length) or training will raise an error.</p><p>For example, to load a <em>Qwen/Qwen2.5-Coder-3B</em> and a <em>Qwen/Qwen2.5-Coder-7B</em>:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>trainer <span style=color:#666>=</span> MAGRPOTrainer(
</span></span><span style=display:flex><span>    agent_model<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>,
</span></span><span style=display:flex><span>    agents<span style=color:#666>=</span>[<span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-3B&#34;</span>, <span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-7B&#34;</span>],
</span></span><span style=display:flex><span>    num_agents<span style=color:#666>=</span><span style=color:#40a070>2</span>,
</span></span><span style=display:flex><span>)</span></span></code></pre></div><h2 id=loading-llm-critics>Loading LLM Critics<a class=anchor href=#loading-llm-critics>#</a></h2><p>The loading of critics depends on the algorithm and the <code>use_separate_critic</code> setting.
In Multi-Agent Actor-Critic (MAAC), a single separated centralized critic is used, so one model should be provided in <code>critic_model</code> or <code>critics</code> without any constraints on model types.</p><p>For example, to load a <em>Qwen/Qwen2.5-Coder-3B</em> and a <em>Qwen/Qwen2.5-Coder-1.5B</em> with a centralized <em>Qwen/Qwen2.5-Coder-7B</em> critic:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>trainer <span style=color:#666>=</span> MAACTrainer(
</span></span><span style=display:flex><span>    agent_model<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>,
</span></span><span style=display:flex><span>    agents<span style=color:#666>=</span>[<span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-3B&#34;</span>, <span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-1.5B&#34;</span>],
</span></span><span style=display:flex><span>    critic_model<span style=color:#666>=</span><span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-7B&#34;</span>,
</span></span><span style=display:flex><span>    critics<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>,
</span></span><span style=display:flex><span>    num_agents<span style=color:#666>=</span><span style=color:#40a070>2</span>,
</span></span><span style=display:flex><span>)</span></span></code></pre></div><p>In Independent Actor-Critic (IAC), each agent can have its own critic. When <code>use_separate_critic=true</code>, users should provide <code>critic_model.name</code> or <code>critics</code> with length <code>num_agents</code> to load separate critics for each agent.
When <code>use_separate_critic=false</code>, each agent shares its LLM agent backbone with its critic, and the critic is loaded at the same time as the agent. In this case, <code>critic_model</code> and <code>critics</code> should not be provided and set to null or None.
Similarly to agents, if both <code>critic_model</code> and <code>critics</code> are provided, they must match (same names, correct length) or training will raise an error.</p><p>For example, to load a <em>Qwen/Qwen2.5-Coder-3B</em> and a <em>Qwen/Qwen2.5-Coder-7B</em> with separate critics of the same models:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>trainer <span style=color:#666>=</span> IACTrainer(
</span></span><span style=display:flex><span>    agent_model<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>,
</span></span><span style=display:flex><span>    agents<span style=color:#666>=</span>[<span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-3B&#34;</span>, <span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-7B&#34;</span>],
</span></span><span style=display:flex><span>    critic_model<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>,
</span></span><span style=display:flex><span>    critics<span style=color:#666>=</span>[<span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-3B&#34;</span>, <span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-7B&#34;</span>],
</span></span><span style=display:flex><span>    num_agents<span style=color:#666>=</span><span style=color:#40a070>2</span>,
</span></span><span style=display:flex><span>)</span></span></code></pre></div><p>Or actor can share the same model with its critic:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>trainer <span style=color:#666>=</span> IACTrainer(
</span></span><span style=display:flex><span>    agent_model<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>,
</span></span><span style=display:flex><span>    agents<span style=color:#666>=</span>[<span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-3B&#34;</span>, <span style=color:#4070a0>&#34;Qwen/Qwen2.5-Coder-7B&#34;</span>],
</span></span><span style=display:flex><span>    critic_model<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>,
</span></span><span style=display:flex><span>    critics<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>,
</span></span><span style=display:flex><span>    num_agents<span style=color:#666>=</span><span style=color:#40a070>2</span>,
</span></span><span style=display:flex><span>)</span></span></code></pre></div><blockquote class="book-hint warning"><p>Internally, trainers always work with <code>agents</code>/<code>critics</code> lists. <code>agent_model</code> and <code>critic_model</code> are convenience shortcuts for homogeneous settings; if both are provided, they must be consistent.</p></blockquote><blockquote class="book-hint warning"><p>Tokenizers are loaded per agent by default. If your models use incompatible vocabularies, training may fail (e.g., in shared-critic settings). Prefer models from the same family or ensure tokenizer compatibility.</p></blockquote></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=../../../docs/user-guide/installation/ class="flex align-center"><img src=../../../icons/backward.svg class=book-icon alt=Backward>
<span>Installation</span>
</a></span><span><a href=../../../docs/user-guide/multi-agent-reinforce/ class="flex align-center"><span>Multi-Agent REINFORCE</span>
<img src=../../../icons/forward.svg class=book-icon alt=Forward></a></span></div><div class=book-comments></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>